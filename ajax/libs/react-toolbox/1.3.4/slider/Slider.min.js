"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.Slider=exports.sliderFactory=void 0;var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,n,s){return n&&e(t.prototype,n),s&&e(t,s),t}}(),_react=require("react"),_react2=_interopRequireDefault(_react),_reactDom=require("react-dom"),_reactDom2=_interopRequireDefault(_reactDom),_classnames2=require("classnames"),_classnames3=_interopRequireDefault(_classnames2),_reactCssThemr=require("react-css-themr"),_identifiers=require("../identifiers.js"),_events=require("../utils/events.js"),_events2=_interopRequireDefault(_events),_utils=require("../utils/utils.js"),_utils2=_interopRequireDefault(_utils),_ProgressBar=require("../progress_bar/ProgressBar.js"),_ProgressBar2=_interopRequireDefault(_ProgressBar),_Input=require("../input/Input.js"),_Input2=_interopRequireDefault(_Input),factory=function(e,t){var n=function(n){function s(){var e,t,n,r;_classCallCheck(this,s);for(var a=arguments.length,o=Array(a),i=0;i<a;i++)o[i]=arguments[i];return t=n=_possibleConstructorReturn(this,(e=s.__proto__||Object.getPrototypeOf(s)).call.apply(e,[this].concat(o))),n.state={inputFocused:!1,inputValue:null,sliderLength:0,sliderStart:0},n.handleInputFocus=function(){n.setState({inputFocused:!0,inputValue:n.valueForInput(n.props.value)})},n.handleInputChange=function(e){n.setState({inputValue:e})},n.handleInputBlur=function(e){var t=n.state.inputValue||0;n.setState({inputFocused:!1,inputValue:null},function(){n.props.onChange(n.trimValue(t),e)})},n.handleKeyDown=function(e){[13,27].indexOf(e.keyCode)!==-1&&n.getInput().blur(),38===e.keyCode&&n.addToValue(n.props.step),40===e.keyCode&&n.addToValue(-n.props.step)},n.handleMouseDown=function(e){n.state.inputFocused&&n.getInput().blur(),_events2.default.addEventsToDocument(n.getMouseEventMap()),n.start(_events2.default.getMousePosition(e)),_events2.default.pauseEvent(e)},n.handleMouseMove=function(e){_events2.default.pauseEvent(e),n.move(_events2.default.getMousePosition(e))},n.handleMouseUp=function(){n.end(n.getMouseEventMap())},n.handleResize=function(e,t){var s=_reactDom2.default.findDOMNode(n.refs.progressbar).getBoundingClientRect(),r=s.left,a=s.right,o=t||function(){};n.setState({sliderStart:r,sliderLength:a-r},o)},n.handleSliderBlur=function(){_events2.default.removeEventsFromDocument(n.getKeyboardEvents())},n.handleSliderFocus=function(){_events2.default.addEventsToDocument(n.getKeyboardEvents())},n.handleTouchEnd=function(){n.end(n.getTouchEventMap())},n.handleTouchMove=function(e){n.move(_events2.default.getTouchPosition(e))},n.handleTouchStart=function(e){n.state.inputFocused&&n.getInput().blur(),n.start(_events2.default.getTouchPosition(e)),_events2.default.addEventsToDocument(n.getTouchEventMap()),_events2.default.pauseEvent(e)},r=t,_possibleConstructorReturn(n,r)}return _inherits(s,n),_createClass(s,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.handleResize),this.handleResize()}},{key:"componentWillReceiveProps",value:function(e){this.state.inputFocused&&this.props.value!==e.value&&this.setState({inputValue:this.valueForInput(e.value)})}},{key:"shouldComponentUpdate",value:function(e,t){return this.state.inputFocused||!t.inputFocused}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleResize),_events2.default.removeEventsFromDocument(this.getMouseEventMap()),_events2.default.removeEventsFromDocument(this.getTouchEventMap()),_events2.default.removeEventsFromDocument(this.getKeyboardEvents())}},{key:"addToValue",value:function(e){var t=this.state.inputFocused?parseFloat(this.state.inputValue):this.props.value;t=this.trimValue(t+e),t!==this.props.value&&this.props.onChange(t)}},{key:"getInput",value:function(){return this.refs.input&&this.refs.input.getWrappedInstance?this.refs.input.getWrappedInstance():this.refs.input}},{key:"getKeyboardEvents",value:function(){return{keydown:this.handleKeyDown}}},{key:"getMouseEventMap",value:function(){return{mousemove:this.handleMouseMove,mouseup:this.handleMouseUp}}},{key:"getTouchEventMap",value:function(){return{touchmove:this.handleTouchMove,touchend:this.handleTouchEnd}}},{key:"end",value:function(e){_events2.default.removeEventsFromDocument(e),this.setState({pressed:!1})}},{key:"knobOffset",value:function(){var e=this.props,t=e.max,n=e.min,s=this.state.sliderLength*(this.props.value-n)/(t-n);return 100*s/this.state.sliderLength}},{key:"move",value:function(e){var t=this.positionToValue(e);t!==this.props.value&&this.props.onChange(t)}},{key:"positionToValue",value:function(e){var t=this.state,n=t.sliderStart,s=t.sliderLength,r=this.props,a=r.max,o=r.min,i=r.step,u=(e.x-n)/s*(a-o);return this.trimValue(Math.round(u/i)*i+o)}},{key:"start",value:function(e){var t=this;this.handleResize(null,function(){t.setState({pressed:!0}),t.props.onChange(t.positionToValue(e))})}},{key:"stepDecimals",value:function(){return(this.props.step.toString().split(".")[1]||[]).length}},{key:"trimValue",value:function(e){return e<this.props.min?this.props.min:e>this.props.max?this.props.max:_utils2.default.round(e,this.stepDecimals())}},{key:"valueForInput",value:function(e){var t=this.stepDecimals();return t>0?e.toFixed(t):e.toString()}},{key:"renderSnaps",value:function(){var e=this;if(this.props.snaps)return _react2.default.createElement("div",{ref:"snaps",className:this.props.theme.snaps},_utils2.default.range(0,(this.props.max-this.props.min)/this.props.step).map(function(t){return _react2.default.createElement("div",{key:"span-"+t,className:e.props.theme.snap})}))}},{key:"renderInput",value:function(){if(this.props.editable){var e=this.state.inputFocused?this.state.inputValue:this.valueForInput(this.props.value);return _react2.default.createElement(t,{ref:"input",className:this.props.theme.input,disabled:this.props.disabled,onFocus:this.handleInputFocus,onChange:this.handleInputChange,onBlur:this.handleInputBlur,value:e})}}},{key:"render",value:function(){var t,n=this.props.theme,s={left:this.knobOffset()+"%"},r=(0,_classnames3.default)(n.slider,(t={},_defineProperty(t,n.editable,this.props.editable),_defineProperty(t,n.disabled,this.props.disabled),_defineProperty(t,n.pinned,this.props.pinned),_defineProperty(t,n.pressed,this.state.pressed),_defineProperty(t,n.ring,this.props.value===this.props.min),t),this.props.className);return _react2.default.createElement("div",{className:r,disabled:this.props.disabled,"data-react-toolbox":"slider",onBlur:this.handleSliderBlur,onFocus:this.handleSliderFocus,tabIndex:"0"},_react2.default.createElement("div",{ref:"slider",className:n.container,onMouseDown:this.handleMouseDown,onTouchStart:this.handleTouchStart},_react2.default.createElement("div",{ref:"knob",className:n.knob,onMouseDown:this.handleMouseDown,onTouchStart:this.handleTouchStart,style:s},_react2.default.createElement("div",{className:n.innerknob,"data-value":parseInt(this.props.value)})),_react2.default.createElement("div",{className:n.progress},_react2.default.createElement(e,{disabled:this.props.disabled,ref:"progressbar",className:n.innerprogress,max:this.props.max,min:this.props.min,mode:"determinate",value:this.props.value}),this.renderSnaps())),this.renderInput())}}]),s}(_react.Component);return n.propTypes={className:_react.PropTypes.string,disabled:_react.PropTypes.bool,editable:_react.PropTypes.bool,max:_react.PropTypes.number,min:_react.PropTypes.number,onChange:_react.PropTypes.func,pinned:_react.PropTypes.bool,snaps:_react.PropTypes.bool,step:_react.PropTypes.number,theme:_react.PropTypes.shape({container:_react.PropTypes.string,editable:_react.PropTypes.string,innerknob:_react.PropTypes.string,innerprogress:_react.PropTypes.string,input:_react.PropTypes.string,knob:_react.PropTypes.string,pinned:_react.PropTypes.string,pressed:_react.PropTypes.string,progress:_react.PropTypes.string,ring:_react.PropTypes.string,slider:_react.PropTypes.string,snap:_react.PropTypes.string,snaps:_react.PropTypes.string}),value:_react.PropTypes.number},n.defaultProps={className:"",editable:!1,max:100,min:0,pinned:!1,snaps:!1,step:.01,value:0},n},Slider=factory(_ProgressBar2.default,_Input2.default);exports.default=(0,_reactCssThemr.themr)(_identifiers.SLIDER)(Slider),exports.sliderFactory=factory,exports.Slider=Slider;
//# sourceMappingURL=Slider.min.js.map