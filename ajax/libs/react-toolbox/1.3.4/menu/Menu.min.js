"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _defineProperty(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.Menu=exports.menuFactory=void 0;var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),_react=require("react"),_react2=_interopRequireDefault(_react),_reactDom=require("react-dom"),_reactDom2=_interopRequireDefault(_reactDom),_classnames2=require("classnames"),_classnames3=_interopRequireDefault(_classnames2),_reactCssThemr=require("react-css-themr"),_identifiers=require("../identifiers.js"),_utils=require("../utils"),_MenuItem=require("./MenuItem.js"),_MenuItem2=_interopRequireDefault(_MenuItem),POSITION={AUTO:"auto",STATIC:"static",TOP_LEFT:"topLeft",TOP_RIGHT:"topRight",BOTTOM_LEFT:"bottomLeft",BOTTOM_RIGHT:"bottomRight"},factory=function(e){var t=function(t){function i(){var e,t,r,o;_classCallCheck(this,i);for(var n=arguments.length,s=Array(n),a=0;a<n;a++)s[a]=arguments[a];return t=r=_possibleConstructorReturn(this,(e=i.__proto__||Object.getPrototypeOf(i)).call.apply(e,[this].concat(s))),r.state={active:r.props.active,rippled:!1},r.handleDocumentClick=function(e){r.state.active&&!_utils.events.targetIsDescendant(e,_reactDom2.default.findDOMNode(r))&&r.setState({active:!1,rippled:!1})},r.handleSelect=function(e,t){var i=e.props,o=i.value,n=i.onClick;n&&t.persist(),r.setState({active:!1,rippled:r.props.ripple},function(){n&&n(t),r.props.onSelect&&r.props.onSelect(o)})},o=t,_possibleConstructorReturn(r,o)}return _inherits(i,t),_createClass(i,[{key:"componentDidMount",value:function(){var e=this;this.positionTimeoutHandle=setTimeout(function(){var t=e.refs.menu.getBoundingClientRect(),i=t.width,r=t.height,o=e.props.position===POSITION.AUTO?e.calculatePosition():e.props.position;e.setState({position:o,width:i,height:r})})}},{key:"componentWillReceiveProps",value:function(e){var t=this;if(this.props.position!==e.position){var i=e.position===POSITION.AUTO?this.calculatePosition():e.position;this.setState({position:i})}if(!this.props.active&&e.active&&!this.state.active)if(e.position===POSITION.AUTO){var r=this.calculatePosition();this.state.position!==r?this.setState({position:r,active:!1},function(){t.activateTimeoutHandle=setTimeout(function(){t.show()},20)}):this.show()}else this.show();this.props.active&&!e.active&&this.state.active&&this.hide()}},{key:"componentWillUpdate",value:function(e,t){!this.state.active&&t.active&&_utils.events.addEventsToDocument({click:this.handleDocumentClick,touchstart:this.handleDocumentClick})}},{key:"componentDidUpdate",value:function(e,t){t.active&&!this.state.active?(this.props.onHide&&this.props.onHide(),_utils.events.removeEventsFromDocument({click:this.handleDocumentClick,touchstart:this.handleDocumentClick})):!t.active&&this.state.active&&this.props.onShow&&this.props.onShow()}},{key:"componentWillUnmount",value:function(){this.state.active&&_utils.events.removeEventsFromDocument({click:this.handleDocumentClick,touchstart:this.handleDocumentClick}),clearTimeout(this.positionTimeoutHandle),clearTimeout(this.activateTimeoutHandle)}},{key:"calculatePosition",value:function(){var e=_reactDom2.default.findDOMNode(this).parentNode;if(e){var t=e.getBoundingClientRect(),i=t.top,r=t.left,o=t.height,n=t.width,s=_utils.utils.getViewport(),a=s.height,c=s.width,p=i<a/2-o/2,l=r<c/2-n/2;return""+(p?"top":"bottom")+(l?"Left":"Right")}}},{key:"getMenuStyle",value:function(){var e=this.state,t=e.width,i=e.height,r=e.position;if(r!==POSITION.STATIC){if(this.state.active)return{clip:"rect(0 "+t+"px "+i+"px 0)"};if(r===POSITION.TOP_RIGHT)return{clip:"rect(0 "+t+"px 0 "+t+"px)"};if(r===POSITION.BOTTOM_RIGHT)return{clip:"rect("+i+"px "+t+"px "+i+"px "+t+"px)"};if(r===POSITION.BOTTOM_LEFT)return{clip:"rect("+i+"px 0 "+i+"px 0)"};if(r===POSITION.TOP_LEFT)return{clip:"rect(0 0 0 0)"}}}},{key:"getRootStyle",value:function(){if(this.state.position!==POSITION.STATIC)return{width:this.state.width,height:this.state.height}}},{key:"renderItems",value:function(){var t=this;return _react2.default.Children.map(this.props.children,function(i){return i?i.type===e?_react2.default.cloneElement(i,{ripple:i.props.ripple||t.props.ripple,selected:"undefined"!=typeof i.props.value&&t.props.selectable&&i.props.value===t.props.selected,onClick:t.handleSelect.bind(t,i)}):_react2.default.cloneElement(i):i})}},{key:"show",value:function(){var e=this.refs.menu.getBoundingClientRect(),t=e.width,i=e.height;this.setState({active:!0,width:t,height:i})}},{key:"hide",value:function(){this.setState({active:!1})}},{key:"render",value:function(){var e,t=this.props.theme,i={width:this.state.width,height:this.state.height},r=(0,_classnames3.default)([t.menu,t[this.state.position]],(e={},_defineProperty(e,t.active,this.state.active),_defineProperty(e,t.rippled,this.state.rippled),e),this.props.className);return _react2.default.createElement("div",{"data-react-toolbox":"menu",className:r,style:this.getRootStyle()},this.props.outline?_react2.default.createElement("div",{className:t.outline,style:i}):null,_react2.default.createElement("ul",{ref:"menu",className:t.menuInner,style:this.getMenuStyle()},this.renderItems()))}}]),i}(_react.Component);return t.propTypes={active:_react.PropTypes.bool,children:_react.PropTypes.node,className:_react.PropTypes.string,onHide:_react.PropTypes.func,onSelect:_react.PropTypes.func,onShow:_react.PropTypes.func,outline:_react.PropTypes.bool,position:_react.PropTypes.oneOf(Object.keys(POSITION).map(function(e){return POSITION[e]})),ripple:_react.PropTypes.bool,selectable:_react.PropTypes.bool,selected:_react.PropTypes.any,theme:_react.PropTypes.shape({active:_react.PropTypes.string,bottomLeft:_react.PropTypes.string,bottomRight:_react.PropTypes.string,menu:_react.PropTypes.string,menuInner:_react.PropTypes.string,outline:_react.PropTypes.string,rippled:_react.PropTypes.string,static:_react.PropTypes.string,topLeft:_react.PropTypes.string,topRight:_react.PropTypes.string})},t.defaultProps={active:!1,outline:!0,position:POSITION.STATIC,ripple:!0,selectable:!0},t},Menu=factory(_MenuItem2.default);exports.default=(0,_reactCssThemr.themr)(_identifiers.MENU)(Menu),exports.menuFactory=factory,exports.Menu=Menu;
//# sourceMappingURL=Menu.min.js.map