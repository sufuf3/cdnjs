!function(t){"use strict";function e(t){return"[object Array]"===Object.prototype.toString.call(t)}function r(t){this.string=t}function n(t){this.name=t}function a(t){this.name=t}function s(){}function i(t,e,i){"/"===t.charAt(0)&&(t=t.substr(1));for(var h=t.split("/"),o=[],c=0,u=h.length;c<u;c++){var p,f=h[c];(p=f.match(/^:([^\/]+)$/))?(o.push(new n(p[1])),e.push(p[1]),i.dynamics++):(p=f.match(/^\*([^\/]+)$/))?(o.push(new a(p[1])),e.push(p[1]),i.stars++):""===f?o.push(new s):(o.push(new r(f)),i.statics++)}return o}function h(t){this.charSpec=t,this.nextStates=[]}function o(t){return t.sort(function(t,e){if(t.types.stars!==e.types.stars)return t.types.stars-e.types.stars;if(t.types.stars){if(t.types.statics!==e.types.statics)return e.types.statics-t.types.statics;if(t.types.dynamics!==e.types.dynamics)return e.types.dynamics-t.types.dynamics}return t.types.dynamics!==e.types.dynamics?t.types.dynamics-e.types.dynamics:t.types.statics!==e.types.statics?e.types.statics-t.types.statics:0})}function c(t,e){for(var r=[],n=0,a=t.length;n<a;n++){var s=t[n];r=r.concat(s.match(e))}return r}function u(t){this.queryParams=t||{}}function p(t,e,r){for(var n=t.handlers,a=t.regex,s=e.match(a),i=1,h=new u(r),o=0,c=n.length;o<c;o++){for(var p=n[o],f=p.names,l={},d=0,g=f.length;d<g;d++)l[f[d]]=s[i++];h.push({handler:p.handler,params:l,isDynamic:!!f.length})}return h}function f(t,e){return e.eachChar(function(e){t=t.put(e)}),t}function l(t,e,r){this.path=t,this.matcher=e,this.delegate=r}function d(t){this.routes={},this.children={},this.target=t}function g(t,e,r){return function(n,a){var s=t+n;if(!a)return new l(t+n,e,r);a(g(s,e,r))}}function y(t,e,r){for(var n=0,a=0,s=t.length;a<s;a++)n+=t[a].path.length;var i={path:e=e.substr(n),handler:r};t.push(i)}function v(t,e,r,n){var a=e.routes;for(var s in a)if(a.hasOwnProperty(s)){var i=t.slice();y(i,s,a[s]),e.children[s]?v(i,e.children[s],r,n):r.call(n,i)}}var m=["/",".","*","+","?","|","(",")","[","]","{","}","\\"],w=new RegExp("(\\"+m.join("|\\")+")","g");r.prototype={eachChar:function(t){for(var e=this.string,r=0,n=e.length;r<n;r++)t({validChars:e.charAt(r)})},regex:function(){return this.string.replace(w,"\\$1")},generate:function(){return this.string}},n.prototype={eachChar:function(t){t({invalidChars:"/",repeat:!0})},regex:function(){return"([^/]+)"},generate:function(t){return t[this.name]}},a.prototype={eachChar:function(t){t({invalidChars:"",repeat:!0})},regex:function(){return"(.+)"},generate:function(t){return t[this.name]}},s.prototype={eachChar:function(){},regex:function(){return""},generate:function(){return""}},h.prototype={get:function(t){for(var e=this.nextStates,r=0,n=e.length;r<n;r++){var a=e[r],s=a.charSpec.validChars===t.validChars;if(s=s&&a.charSpec.invalidChars===t.invalidChars)return a}},put:function(t){var e;return(e=this.get(t))?e:(e=new h(t),this.nextStates.push(e),t.repeat&&e.nextStates.push(e),e)},match:function(t){for(var e,r,n,a=this.nextStates,s=[],i=0,h=a.length;i<h;i++)void 0!==(n=(r=(e=a[i]).charSpec).validChars)?-1!==n.indexOf(t)&&s.push(e):void 0!==(n=r.invalidChars)&&-1===n.indexOf(t)&&s.push(e);return s}};var C=Object.create||function(t){function e(){}return e.prototype=t,new e};u.prototype=C({splice:Array.prototype.splice,slice:Array.prototype.slice,push:Array.prototype.push,length:0,queryParams:null});var x=function(){this.rootState=new h,this.names={}};x.prototype={add:function(t,e){for(var r,n=this.rootState,a="^",h={statics:0,dynamics:0,stars:0},o=[],c=[],u=!0,p=0,l=t.length;p<l;p++){var d=t[p],g=[],y=i(d.path,g,h);c=c.concat(y);for(var v=0,m=y.length;v<m;v++){var w=y[v];w instanceof s||(u=!1,a+="/",n=f(n=n.put({validChars:"/"}),w),a+=w.regex())}var C={handler:d.handler,names:g};o.push(C)}u&&(n=n.put({validChars:"/"}),a+="/"),n.handlers=o,n.regex=new RegExp(a+"$"),n.types=h,(r=e&&e.as)&&(this.names[r]={segments:c,handlers:o})},handlersFor:function(t){var e=this.names[t],r=[];if(!e)throw new Error("There is no route named "+t);for(var n=0,a=e.handlers.length;n<a;n++)r.push(e.handlers[n]);return r},hasRoute:function(t){return!!this.names[t]},generate:function(t,e){var r=this.names[t],n="";if(!r)throw new Error("There is no route named "+t);for(var a=r.segments,i=0,h=a.length;i<h;i++){var o=a[i];o instanceof s||(n+="/",n+=o.generate(e))}return"/"!==n.charAt(0)&&(n="/"+n),e&&e.queryParams&&(n+=this.generateQueryString(e.queryParams,r.handlers)),n},generateQueryString:function(t,r){var n=[],a=[];for(var s in t)t.hasOwnProperty(s)&&a.push(s);a.sort();for(var i=0,h=a.length;i<h;i++){var o=t[s=a[i]];if(null!=o){var c=s;if(e(o))for(var u=0,p=o.length;u<p;u++){var f=s+"[]="+encodeURIComponent(o[u]);n.push(f)}else c+="="+encodeURIComponent(o),n.push(c)}}return 0===n.length?"":"?"+n.join("&")},parseQueryString:function(t){for(var e=t.split("&"),r={},n=0;n<e.length;n++){var a,s=e[n].split("="),i=decodeURIComponent(s[0]),h=i.length,o=!1;1===s.length?a="true":(h>2&&"[]"===i.slice(h-2)&&(o=!0,r[i=i.slice(0,h-2)]||(r[i]=[])),a=s[1]?decodeURIComponent(s[1]):""),o?r[i].push(a):r[i]=decodeURIComponent(a)}return r},recognize:function(t){var e,r,n,a,s=[this.rootState],i={},h=!1;if(t=decodeURI(t),-1!==(a=t.indexOf("?"))){var u=t.substr(a+1,t.length);t=t.substr(0,a),i=this.parseQueryString(u)}for("/"!==t.charAt(0)&&(t="/"+t),(e=t.length)>1&&"/"===t.charAt(e-1)&&(t=t.substr(0,e-1),h=!0),r=0,n=t.length;r<n&&(s=c(s,t.charAt(r))).length;r++);var f=[];for(r=0,n=s.length;r<n;r++)s[r].handlers&&f.push(s[r]);s=o(f);var l=f[0];if(l&&l.handlers)return h&&"(.+)$"===l.regex.source.slice(-5)&&(t+="/"),p(l,t,i)}},t.RouteRecognizer=x,l.prototype={to:function(t,e){var r=this.delegate;if(r&&r.willAddRoute&&(t=r.willAddRoute(this.matcher.target,t)),this.matcher.add(this.path,t),e){if(0===e.length)throw new Error("You must have an argument in the function passed to `to`");this.matcher.addChild(this.path,t,e,this.delegate)}return this}},d.prototype={add:function(t,e){this.routes[t]=e},addChild:function(t,e,r,n){var a=new d(e);this.children[t]=a;var s=g(t,a,n);n&&n.contextEntered&&n.contextEntered(e,s),r(s)}},x.prototype.map=function(t,e){var r=new d;t(g("",r,this.delegate)),v([],r,function(t){e?e(this,t):this.add(t)},this)}}(window);